delete from t_global_sql_variables;
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('1', '时间戳转化为分钟', '时间戳转换为时分(HH:mm)', 'date_format', 'FROM_UNIXTIME(@, \"%H:%i\")', 'to_char(@,\'hh:MM\')', '', '', '0', '2020-01-09 15:44:05', '2020-01-09 15:44:08', '', '', b'01');
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('2', 'float数据格式化', 'float格式化，保留两位小微', 'double_format', 'CAST(@ AS DECIMAL(20,2))', '@', '', '', '0', '2020-01-09 15:46:11', '2020-01-09 15:46:14', '', '', b'01');
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('3', '时间格式化为年月日', '时间格式化为年月日 yyyy-mm-dd', 'date_format_date', 'DATE_FORMAT(@, \"%Y-%m-%d\")', 'to_char(@, \'YYYY-MM-DD\')', '', '', '0', '2020-01-09 16:00:18', '2020-01-09 16:00:20', '', '', b'00');
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('4', '获取10天的当前时间', '获取当前时间的10天前时间 ', 'date_sub_10', 'DATE_SUB(@, INTERVAL 10 DAY)', '@ - INTERVAL \'10 DAY\' ', '', '', '0', '2020-01-09 16:03:57', '2020-01-09 16:04:00', '', '', b'00');
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('5', '格式化时间为 yyyy-MM-dd HH:mm:ss', '格式化时间为 yyyy-MM-dd HH:mm:ss', 'date_format_date_time', 'DATE_FORMAT(@, \"%Y-%m-%d %H:%i:%s\")', 'to_char(@,\'yyyy-MM-dd hh:MM:ss\')', '', '', '0', '2020-01-09 20:03:33', '2020-01-09 20:03:39', '', '', b'00');
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('6', '时间戳转化为 年月日 时分秒', '时间戳转化为 年月日 时分秒', 'unixtime_format_date_time', 'FROM_UNIXTIME(@, \"%Y-%m-%d %H:%i:%s\")', 'to_char(@,\'yyyy-MM-dd hh:MM:ss\')', '', '', '0', '2020-01-12 17:53:34', '2020-01-12 17:53:37', '', '', b'00');
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('7', '判断是否为空', '判断是否为空，如果不为空返回第一个参数，为空返回第二个参数', 'ifnull', 'IFNULL', 'COALESCE', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('8', '提取字符中的数字', '提取字符中的数值', 'case_number', 'CAST(@ as unsigned)', 'to_number(@, \'9999999999999999999\')', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('9', '时间格式为 月-日', '时间格式为 月-日 mm-dd格式', 'date_format_month', 'DATE_FORMAT(@, \"%m-%d\")', 'to_char(@, \'MM-DD\')', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('10', '获取当前的时间', '获取当前的年月日时间 格式是yyyy-mm-dd', 'current_date', 'DATE_FORMAT(now(), \"%Y-%m-%d\")', 'current_date', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
INSERT INTO  `t_global_sql_variables` (`id`, `name`, `content`, `function_name`, `mysql_function`, `postgres_function`, `hive_function`, `hbase_function`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`) VALUES ('11', '数值的特殊处理函数', '数值特殊处理函数，postgres在处理除法的时候，返回的严格的数值，不需要处理', 'special_case_number', 'CAST(@ AS DECIMAL(20,2))', '@', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);



delete from `t_task_detail` where id='102';
delete from `t_task_detail` where id='103';
delete from `t_task_detail` where id='105';
delete from `t_task_detail` where id='109';
delete from `t_task_detail` where id='110';
delete from `t_task_detail` where id='112';
delete from `t_task_detail` where id='116';
delete from `t_task_detail` where id='117';
delete from `t_task_detail` where id='118';
delete from `t_task_detail` where id='119';
delete from `t_task_detail` where id='121';
delete from `t_task_detail` where id='501';
delete from `t_task_detail` where id='502';
delete from `t_task_detail` where id='504';
delete from `t_task_detail` where id='505';
delete from `t_task_detail` where id='506';
delete from `t_task_detail` where id='507';
delete from `t_task_detail` where id='510';
delete from `t_task_detail` where id='511';
delete from `t_task_detail` where id='601';
delete from `t_task_detail` where id='602';
delete from `t_task_detail` where id='603';
delete from `t_task_detail` where id='604';
delete from `t_task_detail` where id='606';
delete from `t_task_detail` where id='607';
delete from `t_task_detail` where id='608';
delete from `t_task_detail` where id='609';
delete from `t_task_detail` where id='610';
delete from `t_task_detail` where id='611';
delete from `t_task_detail` where id='612';
delete from `t_task_detail` where id='613';
delete from `t_task_detail` where id='614';
delete from `t_task_detail` where id='999';
delete from `t_task_detail` where id='1003';
delete from `t_task_detail` where id='1302';
delete from `t_task_detail` where id='1304';
delete from `t_task_detail` where id='1305';
delete from `t_task_detail` where id='1306';
delete from `t_task_detail` where id='1309';
delete from `t_task_detail` where id='1311';
delete from `t_task_detail` where id='1312';
delete from `t_task_detail` where id='1315';
delete from `t_task_detail` where id='1317';
delete from `t_task_detail` where id='1318';
delete from `t_task_detail` where id='1322';
delete from `t_task_detail` where id='1325';
delete from `t_task_detail` where id='1601';
delete from `t_task_detail` where id='1602';
delete from `t_task_detail` where id='1603';
delete from `t_task_detail` where id='1604';
delete from `t_task_detail` where id='1605';
delete from `t_task_detail` where id='1606';
delete from `t_task_detail` where id='1607';
delete from `t_task_detail` where id='1701';
delete from `t_task_detail` where id='1702';
delete from `t_task_detail` where id='1703';
delete from `t_task_detail` where id='1704';
delete from `t_task_detail` where id='1705';
delete from `t_task_detail` where id='1706';
delete from `t_task_detail` where id='1707';
delete from `t_task_detail` where id='1307';



INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('102', '1', '1', NULL, '注册会员与实名人数', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	\'\' AS area,\r\n	tt.create_time AS date,\r\n	ttt.count AS pople,\r\n	tt.count AS rate\r\nFROM\r\n	(\r\n		SELECT\r\n			create_time,\r\n			count(1) count\r\n		FROM\r\n			(\r\n				SELECT\r\n					&{date_format_date(@create_time)} AS create_time\r\n				FROM\r\n					customer_info\r\n				WHERE\r\n					create_time >= &{date_sub_10(NOW())}\r\n				AND id_card IS NOT NULL\r\n				ORDER BY\r\n					&{date_format_date(@create_time)} ASC\r\n			) t\r\n		GROUP BY\r\n			create_time\r\n	) tt\r\nJOIN (\r\n	SELECT\r\n		create_time,\r\n		count(1) count\r\n	FROM\r\n		(\r\n			SELECT\r\n				&{date_format_date(@create_time)} AS create_time\r\n			FROM\r\n				customer_info\r\n			WHERE\r\n				create_time >= &{date_sub_10(NOW())}\r\n			ORDER BY\r\n				&{date_format_date(@create_time)} ASC\r\n		) tt\r\n	GROUP BY\r\n		create_time\r\n) ttt ON tt.create_time = ttt.create_time order by date asc ', '每分钟 1 ， 6 开始执行 注册会员与实名人数', '4', '', '0', '', NULL, 'gddata_vip_regist_and_certification', NULL, '1', '1', '3', '1', '2020-02-01 08:43:14', '2020-02-01 08:43:16', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('103', '1', '1', NULL, '区县工会劳模分布', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	out_table_1.name as stree ,\r\n	\'成都市\' as area,\r\n	shijlmrs,\r\n	shengjlmrs,\r\n	gjlmrs\r\nFROM\r\n	(\r\n		SELECT\r\n			t_district.name AS name,\r\n			count(1) shijlmrs\r\n		FROM\r\n			model_worker_info\r\n		JOIN t_district ON address LIKE CONCAT(\'%\', t_district.name, \'%\') and  t_district.name != \'成都市\'\r\n		WHERE\r\n			hornor LIKE \'%成都市%\'\r\n		GROUP BY\r\n			t_district.name\r\n	) out_table_1\r\nJOIN (\r\n	SELECT\r\n		t_district.name AS name,\r\n		count(1) shengjlmrs\r\n	FROM\r\n		model_worker_info\r\n	JOIN t_district ON address LIKE CONCAT(\'%\', t_district.name, \'%\') and  t_district.name != \'成都市\'\r\n	WHERE\r\n		hornor LIKE \'%四川省%\'\r\n	GROUP BY\r\n		t_district.name\r\n) out_table_2 ON out_table_2.name = out_table_1.name\r\nJOIN (\r\n	SELECT\r\n		t_district.name AS name,\r\n		count(1) gjlmrs\r\n	FROM\r\n		model_worker_info\r\n	JOIN t_district ON address LIKE CONCAT(\'%\', t_district.name, \'%\') and  t_district.name != \'成都市\'\r\n	WHERE\r\n		hornor LIKE \'%国%\'\r\n	GROUP BY\r\n		t_district.name\r\n) out_table_3 ON out_table_3.name = out_table_1.name', '区县工会劳模分布， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'gddata_nmgj_distribution', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('105', '1', '1', NULL, '工会大屏，实时数据-6个card', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'select \r\n(select count(1) as memberSum from customer_info) as qsghzchy ,\r\n(select count(1) AS count from admin_organization) as qszzs,\r\n(select count(1) as workerCount  from model_worker_info) as nmhys,\r\n \'3526\' as cyghzchys,\r\n(select count(1)  from customer_info where create_time >= &{current_date} ) as jrzchys,\r\n(select  number as ●createTime●  from t_online_member_count ORDER BY ●_CREATE_TIME_● DESC limit 1) as zxhys,\r\n\'成都市\' as area ', '工会大屏，实时数据-6个card', '4', '', '0', '', NULL, 'ghdata_real_time_data', NULL, '1', '1', '3', '1', '2020-02-04 15:03:44', '2020-02-04 15:03:46', '', '', b'00', '36', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('109', '1', '1', NULL, '新增注册会员数', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n \'\' as area,\r\n	create_time  as date,\r\n	count(1) as pople_number\r\nFROM\r\n	(\r\n		SELECT\r\n			&{date_format_date(@create_time)} AS create_time,\r\n			labor_union_id labor_union_id\r\n		FROM\r\n			customer_info\r\n		WHERE\r\n			create_time >= &{date_sub_10(NOW())}\r\n	) b\r\nGROUP BY\r\n	create_time\r\nORDER BY\r\n	create_time ASC', '新增注册会员数， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'ghdata_regist_vip_datas', NULL, '1', '1', '3', '1', '2020-01-09 16:07:50', '2020-01-09 16:07:48', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('110', '1', '1', NULL, '区县工会消费数据', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	DISTINCT stree,online,offine, area\r\nFROM\r\n	(\r\n		SELECT\r\n			&{ifnull(\r\n				out_tabale_1.pay_time,\r\n				out_table_2.pay_time\r\n			)} AS stree,\r\n			&{ifnull(out_tabale_1.cpCount, 0)} AS online,\r\n			&{ifnull(out_table_2.cpCount, 0)} AS offine,\'成都市\' as area\r\n		FROM\r\n			(\r\n				SELECT\r\n					&{date_format_date(@pay_time)} AS pay_time,\r\n					sum(amount) / 100 cpCount\r\n				FROM\r\n					pay_cashier_orders\r\n				WHERE\r\n					state = 2\r\n				AND pay_time IS NOT NULL\r\n				GROUP BY\r\n					&{date_format_date(@pay_time)}\r\n			) out_tabale_1\r\n		LEFT JOIN (\r\n			SELECT\r\n				&{date_format_date(@pay_time)} AS pay_time,\r\n				sum(total_money) / 100 cpCount\r\n			FROM\r\n				order_item\r\n			WHERE\r\n				(\r\n					order_status = 4\r\n					OR order_status = 7\r\n				)\r\n			GROUP BY\r\n				&{date_format_date(@pay_time)}\r\n		) out_table_2 ON out_table_2.pay_time = out_tabale_1.pay_time\r\n	) out_table_1_1\r\nUNION\r\n	(\r\n		SELECT\r\n			&{ifnull(\r\n				out_tabale_1.pay_time,\r\n				out_table_2.pay_time\r\n			)} AS stree,\r\n			&{ifnull(out_tabale_1.cpCount, 0)} AS online,\r\n			&{ifnull(out_table_2.cpCount, 0)} AS offine,\'成都市\' as area\r\n		FROM\r\n			(\r\n				SELECT\r\n					&{date_format_date(@pay_time)} AS pay_time,\r\n					sum(amount) / 100 cpCount\r\n				FROM\r\n					pay_cashier_orders\r\n				WHERE\r\n					state = 2\r\n				AND pay_time IS NOT NULL\r\n				GROUP BY\r\n					&{date_format_date(@pay_time)}\r\n			) out_tabale_1\r\n		RIGHT JOIN (\r\n			SELECT\r\n				&{date_format_date(@pay_time)} AS pay_time,\r\n				sum(total_money) / 100 cpCount\r\n			FROM\r\n				order_item\r\n			WHERE\r\n				(\r\n					order_status = 4\r\n					OR order_status = 7\r\n				)\r\n			GROUP BY\r\n				&{date_format_date(@pay_time)}\r\n		) out_table_2 ON out_table_2.pay_time = out_tabale_1.pay_time\r\n	) \r\nORDER BY stree desc', '区县工会消费数据， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'ghdata_qxghxf_datas', NULL, '1', '1', '3', '1', '2020-01-09 18:22:57', '2020-01-09 18:22:57', '', '', b'01', '36', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('112', '1', '1', NULL, '工会数据大屏-实时数据', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'select \r\n(select count(1) as memberSum from customer_info) as qsghzchy ,\r\n(select count(1) as workerCount  from model_worker_info) as nmhys,\r\n(select count(id_card) as count from customer_info where id_card is not null) smrzhys,\r\n(select  number as createTime  from t_online_member_count ORDER BY ●_CREATE_TIME_● DESC limit 1) as zxhys,\r\n\'成都市\' as area ', '工会数据大屏-实时数据， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'ghdata_data_huizong', NULL, '1', '1', '3', '1', '2020-01-09 18:30:30', '2020-01-09 18:30:30', '', '', b'00', '36', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('116', '1', '1', NULL, '职工技能大赛类型分布', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	skill_type,\r\n	sum(rate) AS rate\r\nFROM\r\n	(\r\n		SELECT\r\n			&{ifnull(\r\n				table1.type_work_name,\r\n				\'其他\'\r\n			)} AS skill_type,\r\n			&{ifnull(table1.cout, table2.cout)} AS rate\r\n		FROM\r\n			(\r\n				SELECT\r\n					type_work_name,\r\n					cout\r\n				FROM\r\n					(\r\n						SELECT\r\n							type_work_name,\r\n							count(1) AS cout\r\n						FROM\r\n							skills_match\r\n						WHERE\r\n							type_work_name IS NOT NULL\r\n						GROUP BY\r\n							type_work_name\r\n					) b\r\n				ORDER BY\r\n					cout DESC\r\n				LIMIT 8\r\n			) table1\r\n		RIGHT JOIN (\r\n			SELECT\r\n				type_work_name,\r\n				count(1) AS cout\r\n			FROM\r\n				skills_match\r\n			WHERE\r\n				type_work_name IS NOT NULL\r\n			GROUP BY\r\n				type_work_name\r\n		) table2 ON table2.type_work_name = table1.type_work_name\r\n	) out_table\r\nGROUP BY\r\n	skill_type', '职工技能大赛类型分布， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'ghdata_skill_game_type', NULL, '1', '1', '3', '1', '2020-01-09 16:40:14', '2020-01-09 16:40:14', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('117', '1', '1', NULL, '百万职工技能大赛报名情况', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	union_name AS NAME,\r\n	type_work_name AS ssgh,\r\n	&{date_format_date(@match_begin_time)} AS start_time,\r\n	count(1) AS current_user_count\r\nFROM\r\n	(\r\n		SELECT\r\n			skills_match.union_name,\r\n			skills_match.type_work_name,\r\n			skills_match.match_begin_time\r\n		FROM\r\n			skills_match\r\n		JOIN skills_signup_person ON skills_signup_person.match_id = skills_match.id\r\n	) out_table_1\r\nGROUP BY\r\n	union_name,\r\n	type_work_name,\r\n	match_begin_time\r\nORDER BY\r\n	match_begin_time DESC', '百万职工技能大赛报名情况， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'ghdata_skill_game_table', NULL, '1', '1', '3', '1', '2020-01-09 17:03:37', '2020-01-09 17:03:37', '', '', b'01', '36', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('118', '1', '1', NULL, '职工婚恋实时认证名单', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	CONCAT(first_name, star) AS NAME,\r\n	gender AS sex,\r\n	CASE phone_length\r\nWHEN 0 THEN\r\n	\'\'\r\nELSE\r\n	CONCAT(\r\n		phone_first,\r\n		\'****\',\r\n		phone_end\r\n	)\r\nEND AS phone,\r\n &{date_format_date_time(@create_time)} AS authentication_time,\r\n is_accept\r\nFROM\r\n	(\r\n		SELECT\r\n			substring(enter_name FROM 1 FOR 1) AS first_name,\r\n			CASE LENGTH(enter_name) / 3\r\n		WHEN 1 THEN\r\n			\'*\'\r\n		WHEN 2 THEN\r\n			\'**\'\r\n		WHEN 3 THEN\r\n			\'***\'\r\n		END AS star,\r\n		LENGTH(enter_iphone) AS phone_length,\r\n		substring(enter_iphone FROM 1 FOR 3) AS phone_first,\r\n		substring(\r\n			enter_iphone\r\n			FROM\r\n				LENGTH(enter_iphone) - 3 FOR LENGTH(enter_iphone)\r\n		) AS phone_end,\r\n		create_time,\r\n		gender,\r\n		CASE examine_status\r\n	WHEN 0 THEN\r\n		\'待审核\'\r\n	WHEN 1 THEN\r\n		\'审核通过\'\r\n	WHEN 2 THEN\r\n		\'审核不通过\'\r\n	END AS is_accept\r\n	FROM\r\n		wedding_enter_name\r\n	ORDER BY\r\n		create_time DESC\r\n	) tmp', '职工婚恋实时认证名单， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'ghdata_love_authentication', NULL, '1', '1', '3', '1', '2020-01-09 20:04:52', '2020-01-09 20:04:52', '', '', b'00', '36', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('119', '1', '1', NULL, '区县工会职工技能大赛分布', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	in_table_1.union_name AS area,\r\n	in_table_1.count AS count\r\nFROM\r\n	(\r\n		SELECT\r\n			REPLACE (union_name, \'总工会\', \'\') AS union_name,\r\n			count(1) count\r\n		FROM\r\n			skills_match\r\n		GROUP BY\r\n			union_name\r\n	) in_table_1\r\nJOIN t_district ON in_table_1.union_name = t_district. NAME\r\nORDER BY\r\n	in_table_1.count DESC\r\nLIMIT 15', '区县工会职工技能大赛分布， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'ghdata_skill_game_distribute', NULL, '1', '1', '3', '1', '2020-01-09 16:47:45', '2020-01-09 16:47:45', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('121', '1', '1', NULL, '职工婚恋实时配对名单', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'select &{date_format_date_time(@match_time)}  as match_time, \r\nCONCAT(first_name,send_use_name_star) as send_use_name, \r\nCONCAT(send_user_phone_first, \'****\',end_send_phone ) as send_user_phone, \r\nCONCAT(first_recevid_user_name,recevid_user_name_star) as recevid_user_name,\r\nCONCAT(first_recevid_phone, \'****\',end_recevid_phone ) as recevid_user_phone\r\n from (\r\nSELECT\r\n	match_time,\r\n	substring(send_use_name FROM 1 FOR 1) AS first_name,\r\n	CASE send_use_name_length\r\nWHEN 1 THEN\r\n	\'*\'\r\nWHEN 2 THEN\r\n	\'**\'\r\nWHEN 3 THEN\r\n	\'***\'\r\nEND AS send_use_name_star,\r\n substring(send_user_phone FROM 1 FOR 3) AS send_user_phone_first,\r\n substring(\r\n	send_user_phone\r\n	FROM\r\n		send_user_phone_length - 4 FOR send_user_phone_length\r\n) AS end_send_phone,substring(recevid_user_name FROM 1 FOR 1) AS first_recevid_user_name,\r\n CASE recevid_user_name_length\r\nWHEN 1 THEN\r\n	\'*\'\r\nWHEN 2 THEN\r\n	\'**\'\r\nWHEN 3 THEN\r\n	\'***\'\r\nEND AS recevid_user_name_star,\r\n substring(\r\n	recevid_user_phone\r\n	FROM\r\n		1 FOR 3\r\n) AS first_recevid_phone,\r\n substring(\r\n	recevid_user_phone\r\n	FROM\r\n		recevid_user_phone_length - 4 FOR recevid_user_phone_length\r\n) AS end_recevid_phone\r\nFROM\r\n	(\r\n		SELECT DISTINCT\r\n			accept_time AS match_time,\r\n			out_table_3.enter_name AS send_use_name,\r\n			LENGTH(out_table_3.enter_name) / 3 - 1 AS send_use_name_length,\r\n			out_table_3.enter_iphone AS send_user_phone,\r\n			LENGTH(out_table_3.enter_iphone) AS send_user_phone_length,\r\n			out_table_2.enter_name AS recevid_user_name,\r\n			LENGTH(out_table_2.enter_name) / 3 - 1 AS recevid_user_name_length,\r\n			out_table_2.enter_iphone AS recevid_user_phone,\r\n			LENGTH(out_table_2.enter_iphone) AS recevid_user_phone_length\r\n		FROM\r\n			(\r\n				SELECT\r\n					initiator_user_id,\r\n					accept_user_id,\r\n					accept_time\r\n				FROM\r\n					wedding_safe_user_relation\r\n				WHERE\r\n					is_accept = 1\r\n			) out_table_1\r\n		JOIN (\r\n			SELECT\r\n				enter_name,\r\n				initiator_user_id,\r\n				enter_iphone\r\n			FROM\r\n				wedding_safe_user_relation\r\n			JOIN wedding_enter_name ON wedding_enter_name.app_user_id = wedding_safe_user_relation.initiator_user_id\r\n			WHERE\r\n				is_accept = 1\r\n		) out_table_2 ON out_table_2.initiator_user_id = out_table_1.initiator_user_id\r\n		JOIN (\r\n			SELECT\r\n				enter_name,\r\n				accept_user_id,\r\n				enter_iphone\r\n			FROM\r\n				wedding_safe_user_relation\r\n			JOIN wedding_enter_name ON wedding_enter_name.app_user_id = accept_user_id\r\n			WHERE\r\n				is_accept = 1\r\n		) out_table_3 ON out_table_3.accept_user_id = out_table_1.accept_user_id\r\n	) tmp_inner_table) tmp order by match_time desc', '职工婚恋实时配对名单， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'ghdata_match_info_list', NULL, '1', '1', '3', '1', '2020-01-10 10:14:05', '2020-01-10 10:14:05', '', '', b'00', '36', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('501', '1', '1', NULL, '服务器整体监控', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n table1.server_id AS service_id,\r\n round ( table1.VALUE, 2 ) AS cpu_usage,\r\n round ( table2.VALUE, 2 ) AS load_num,\r\n round ( table3.VALUE, 2 ) AS memory_usage,\r\n round ( table4.VALUE, 2 ) AS disk_usage,\r\n round ( table5.VALUE, 2 ) AS free_usage \r\nFROM\r\n (\r\n SELECT\r\n  endpoint AS server_id,\r\n  application AS application,\r\n  &{date_format(@create_time)} AS date_time,\r\n  counter,\r\n  VALUE \r\n FROM\r\n  wareahouse_open_falcon_src \r\n WHERE\r\n  ●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'cpu.user\'  ) \r\n  AND counter = \'cpu.user\' \r\n ) table1\r\n JOIN (\r\n SELECT\r\n  endpoint AS server_id,\r\n  application AS application,\r\n  &{date_format(@create_time)} AS date_time,\r\n  counter,\r\n  VALUE \r\n FROM\r\n  wareahouse_open_falcon_src \r\n WHERE\r\n  ●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'load.1min\' ) \r\n  AND counter =  \'load.1min\'  \r\n ) table2 ON table2.server_id = table1.server_id\r\n JOIN (\r\n SELECT\r\n  endpoint AS server_id,\r\n  application AS application,\r\n  &{date_format(@create_time)} AS date_time,\r\n  counter,\r\n  VALUE \r\n FROM\r\n  wareahouse_open_falcon_src \r\n WHERE\r\n  ●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE  counter =  \'mem.memfree.percent\'  ) \r\n  AND counter =  \'mem.memfree.percent\' \r\n ) table3 ON table1.server_id = table3.server_id\r\n JOIN (\r\n SELECT\r\n  endpoint AS server_id,\r\n  application AS application,\r\n  &{date_format(@create_time)} AS date_time,\r\n  counter,\r\n  VALUE \r\n FROM\r\n  wareahouse_open_falcon_src \r\n WHERE\r\n  ●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter =  \'df.statistics.used.percent\'  ) \r\n  AND counter =  \'df.statistics.used.percent\'  \r\n ) table4 ON table1.server_id = table4.server_id\r\n JOIN (\r\n SELECT\r\n  endpoint AS server_id,\r\n  application AS application,\r\n  &{date_format(@create_time)} AS date_time,\r\n  counter,\r\n  VALUE \r\n FROM\r\n  wareahouse_open_falcon_src \r\n WHERE\r\n  ●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'df.bytes.free.percent/fstype=xfs,mount=/\' ) \r\n  AND counter = \'df.bytes.free.percent/fstype=xfs,mount=/\'  \r\n ) table5 ON table1.server_id = table5.server_id\r\n AND table1.date_time = table2.date_time \r\n AND table1.date_time = table3.date_time \r\n AND table1.date_time = table4.date_time \r\n AND table1.date_time = table4.date_time;', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_essentials_monitor', NULL, '1', '1', '3', '1', '2019-12-20 16:17:16', '2019-12-20 16:17:16', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('502', '1', '1', NULL, '服务器监控-内存使用率', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n table1.server_id AS service_id,\r\n table1.date_time AS date_time,\r\n round ( table1.VALUE, 2 ) AS memory_usage \r\nFROM\r\n (\r\n SELECT\r\n  endpoint AS server_id,\r\n  application AS application,\r\n  &{date_format(@create_time)} AS date_time,\r\n  counter,\r\n  VALUE \r\n FROM\r\n  wareahouse_open_falcon_src \r\n WHERE\r\n  ●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'mem.memfree.percent\'  ) \r\n AND counter = \'mem.memfree.percent\' \r\n ) table1', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_physics_memory_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('504', '1', '1', NULL, '服务器监控-磁盘信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', ' SELECT\r\n table1.server_id AS service_id,\r\n table1.date_time AS date_time,\r\n round ( table1.VALUE, 2 ) AS disk_usage \r\nFROM\r\n (\r\n SELECT\r\n  endpoint AS server_id,\r\n  application AS application,\r\n  &{date_format(@create_time)} AS date_time,\r\n  counter,\r\n  VALUE\r\n FROM\r\n  wareahouse_open_falcon_src \r\n WHERE\r\n  ●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'df.statistics.used.percent\' ) \r\n AND counter = \'df.statistics.used.percent\'  \r\n ) table1', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_desk_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('505', '1', '1', NULL, '服务器监控-CPU信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\ntable2.server_id  as service_id,\r\n	table1.date_time AS date_time,\r\n	round ( table1.VALUE, 2 ) AS user_time,\r\n	round ( table2.VALUE, 2 ) AS system_time \r\nFROM\r\n	(\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'cpu.user\' ) \r\n		AND counter = \'cpu.user\'  \r\n	) table1\r\n	JOIN (\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'cpu.system\'  ) \r\n		AND counter = \'cpu.system\'  \r\n	) table2 ON table2.server_id = table1.server_id \r\n	AND table2.date_time = table1.date_time\r\n', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_cpu_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('506', '1', '1', NULL, '服务器监控-文件系统信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n table1.server_id AS service_id,\r\n table1.date_time AS date_time,\r\n round ( table2.VALUE, 2 ) AS free_count,\r\n round ( table2.VALUE, 2 ) AS total_count \r\nFROM\r\n (\r\n SELECT\r\n  endpoint AS server_id,\r\n  application AS application,\r\n  &{date_format(@create_time)} AS date_time,\r\n  counter,\r\n  VALUE \r\n FROM\r\n  wareahouse_open_falcon_src \r\n WHERE\r\n  ●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'df.statistics.used.percent\' ) \r\n  AND counter = \'df.statistics.used.percent\' \r\n ) table1\r\n JOIN (\r\n SELECT\r\n  endpoint AS server_id,\r\n  application AS application,\r\n  &{date_format(@create_time)} AS date_time,\r\n  counter,\r\n  VALUE \r\n FROM\r\n  wareahouse_open_falcon_src \r\n WHERE\r\n  ●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'df.statistics.used\' ) \r\n  AND counter = \'df.statistics.used\' \r\n ) table2 ON table2.server_id = table1.server_id\r\n JOIN (\r\n SELECT\r\n  endpoint AS server_id,\r\n  application AS application,\r\n  &{date_format(@create_time)} AS date_time,\r\n  counter,\r\n  VALUE \r\n FROM\r\n  wareahouse_open_falcon_src \r\n WHERE\r\n  ●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'df.statistics.total\' ) \r\n  AND counter = \'df.statistics.total\'\r\n ) table3 ON table3.server_id = table1.server_id\r\n AND table2.date_time = table1.date_time \r\n AND table3.date_time = table1.date_time', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_file_system_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('507', '1', '1', NULL, '服务器监控-网卡信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n  table1.server_id AS service_id,\r\n  table1.date_time AS date_time,\r\n  round ( table2.VALUE, 2 ) AS net_in,\r\n  round ( table2.VALUE, 2 ) AS net_out\r\nFROM\r\n  (\r\n    SELECT\r\n      endpoint AS server_id,\r\n      application AS application,\r\n      &{date_format(@create_time)} AS date_time,\r\n      counter,\r\n      VALUE\r\n    FROM\r\n      wareahouse_open_falcon_src\r\n    WHERE\r\n      ●_CREATE_TIME_● = (\r\n        SELECT\r\n          max(●_CREATE_TIME_●)\r\n        FROM\r\n          wareahouse_open_falcon_src\r\n        WHERE\r\n          counter = \'net.if.in.bytes/iface=eth0\'\r\n      )\r\n    AND counter  = \'net.if.in.bytes/iface=eth0\'\r\n  ) table1\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'net.if.in.bytes/iface=eth0\'\r\n    )\r\n  AND counter = \'net.if.in.bytes/iface=eth0\'\r\n) table2 ON table2.server_id = table1.server_id\r\nAND table2.date_time = table1.date_time AND table2.date_time = table1.date_time', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_network_card_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('510', '1', '1', NULL, '服务器监控-CPU信息切换', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n  table1.server_id AS service_id,\r\n  table1.date_time AS date_time,\r\n	ROUND(table1.VALUE, 2 ) AS cpu_switches\r\nFROM\r\n  (\r\n    SELECT\r\n      endpoint AS server_id,\r\n      application AS application,\r\n      &{date_format(@create_time)} AS date_time,\r\n      counter,\r\n      VALUE\r\n    FROM\r\n      wareahouse_open_falcon_src\r\n    WHERE\r\n      ●_CREATE_TIME_● = (\r\n        SELECT\r\n          max(●_CREATE_TIME_●)\r\n        FROM\r\n          wareahouse_open_falcon_src\r\n        WHERE\r\n          counter = \'cpu.switches\'\r\n      )\r\n    AND counter = \'cpu.switches\'\r\n  ) table1', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_cpu_jumps', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('511', '1', '1', NULL, '服务器-负载情况', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n  table1.server_id AS service_id,\r\n  table1.date_time AS date_time,\r\n	ROUND ( table1.VALUE, 2 ) AS load_num\r\nFROM\r\n  (\r\n    SELECT\r\n      endpoint AS server_id,\r\n      application AS application,\r\n      &{date_format(@create_time)} AS date_time,\r\n      counter,\r\n      VALUE\r\n    FROM\r\n      wareahouse_open_falcon_src\r\n    WHERE\r\n      ●_CREATE_TIME_● = (\r\n        SELECT\r\n          max(●_CREATE_TIME_●)\r\n        FROM\r\n          wareahouse_open_falcon_src\r\n        WHERE\r\n          counter = \'load.1min\'\r\n      )\r\n    AND counter = \'load.1min\'\r\n  ) table1', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_load_monitor', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('601', '1', '1', NULL, 'Java监控-线程信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n  table1.server_id AS service_id,\r\n  table1.date_time AS date_time,\r\n table1.application AS application,\r\n	ROUND ( table2.VALUE, 2 ) AS start_thread_sum,\r\n	ROUND ( table2.VALUE, 2 ) AS jvm_start_or_activity_thread_count\r\nFROM\r\n  (\r\n    SELECT\r\n      endpoint AS server_id,\r\n      application AS application,\r\n      &{date_format(@create_time)} AS date_time,\r\n      counter,\r\n      VALUE\r\n    FROM\r\n      wareahouse_open_falcon_src\r\n    WHERE\r\n      ●_CREATE_TIME_● = (\r\n        SELECT\r\n          max(●_CREATE_TIME_●)\r\n        FROM\r\n          wareahouse_open_falcon_src\r\n        WHERE\r\n          counter = \'thread.active.count\'\r\n      )\r\n    AND counter= \'thread.active.count\'\r\n  ) table1\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'thread.peak.count\'\r\n    )\r\n  AND counter = \'thread.peak.count\'\r\n) table2 ON table2.server_id = table1.server_id\r\nAND table1.application = table2.application\r\nAND table2.date_time = table1.date_time ', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_thread_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('602', '1', '1', NULL, 'Java内存使用情况', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n  table1.server_id AS service_id,\r\n  table1.date_time AS date_time,\r\n table1.application AS application,\r\n	ROUND ( table2.VALUE, 2 ) AS gen_mem_used,\r\n	ROUND ( table2.VALUE, 2 ) AS gen_mem_ratio\r\nFROM\r\n  (\r\n    SELECT\r\n      endpoint AS server_id,\r\n      application AS application,\r\n      &{date_format(@create_time)} AS date_time,\r\n      counter,\r\n      VALUE\r\n    FROM\r\n      wareahouse_open_falcon_src\r\n    WHERE\r\n      ●_CREATE_TIME_● = (\r\n        SELECT\r\n          max(●_CREATE_TIME_●)\r\n        FROM\r\n          wareahouse_open_falcon_src\r\n        WHERE\r\n          counter = \'old.gen.mem.ratio\'\r\n      )\r\n    AND counter = \'old.gen.mem.ratio\'\r\n  ) table1\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'thread.peak.count\'\r\n    )\r\n  AND counter = \'thread.peak.count\'\r\n) table2 ON table2.server_id = table1.server_id\r\nAND table1.application = table2.application\r\nAND table2.date_time = table1.date_time ', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_java_storage_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('603', '1', '1', NULL, 'Java监控-内存信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	table1.server_id AS service_id,\r\n	table1.date_time AS date_time,\r\n	table1.application AS application,\r\n	ROUND ( table1.VALUE, 2 ) AS start_thread_sum,\r\n	ROUND ( table2.VALUE, 2 ) AS jvm_start_or_activity_thread_count \r\nFROM\r\n	(\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'new.gen.promotion\' ) \r\n		AND counter  = \'new.gen.promotion\' \r\n	) table1\r\n	JOIN (\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'new.gen.avg.promotion\' ) \r\n		AND counter = \'new.gen.avg.promotion\' \r\n	) table2 ON table2.server_id = table1.server_id \r\n	AND table1.application = table2.application \r\n	AND table2.date_time = table1.date_time', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_class_upload_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('604', '1', '1', NULL, 'Java监控-垃圾回收器信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n  table1.server_id AS service_id,\r\n  table1.date_time AS date_time,\r\n table1.application AS application,\r\n	ROUND ( table1.VALUE, 2 ) AS gc_scavenge_count,\r\n	ROUND ( table2.VALUE, 2 ) AS gc_scavenge_second_count,\r\n	ROUND ( table3.VALUE, 2 ) AS gc_gather_count,\r\n	ROUND ( table4.VALUE, 2 ) AS gc_gather_second_count\r\nFROM\r\n  (\r\n    SELECT\r\n      endpoint AS server_id,\r\n      application AS application,\r\n      &{date_format(@create_time)} AS date_time,\r\n      counter,\r\n      VALUE\r\n    FROM\r\n      wareahouse_open_falcon_src\r\n    WHERE\r\n      ●_CREATE_TIME_● = (\r\n        SELECT\r\n          max(●_CREATE_TIME_●)\r\n        FROM\r\n          wareahouse_open_falcon_src\r\n        WHERE\r\n          counter = \'ps marksweep.gc.avg.time\'\r\n      )\r\n    AND counter = \'ps marksweep.gc.avg.time\'\r\n  ) table1\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'ps marksweep.gc.count\'\r\n    )\r\n  AND counter = \'ps marksweep.gc.count\'\r\n) table2 ON table2.server_id = table1.server_id\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'ps scavenge.gc.avg.time\'\r\n    )\r\n  AND counter = \'ps scavenge.gc.avg.time\'\r\n) table3 ON table2.server_id = table3.server_id\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'ps scavenge.gc.count\'\r\n    )\r\n  AND counter = \'ps scavenge.gc.count\'\r\n) table4 ON table4.server_id = table3.server_id\r\nAND table1.application = table2.application\r\nAND table2.application = table3.application\r\nAND table3.application = table4.application\r\nAND table2.date_time = table1.date_time \r\nAND table2.date_time = table3.date_time \r\nAND table3.date_time = table4.date_time ', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_gc_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('606', '1', '1', NULL, 'Mysql监控-状态信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	table1.server_id AS service_id,\r\n	table1.date_time AS date_time,\r\n	table1.application AS application\r\nFROM\r\n	(\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter =  \'Select_range\' ) \r\n	AND counter = \'Select_range\' \r\n	) table1', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_mysql_state_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('607', '1', '1', NULL, 'Mysql监控-吞吐量信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n  table1.server_id AS service_id,\r\n  table1.date_time AS date_time,\r\n table1.application AS application,\r\n	ROUND ( table1.VALUE, 2 ) AS select_count,\r\n	ROUND ( table2.VALUE, 2 ) AS insert_count,\r\n	ROUND ( table3.VALUE, 2 ) AS update_count,\r\n	ROUND ( table4.VALUE, 2 ) AS delete_count\r\nFROM\r\n  (\r\n    SELECT\r\n      endpoint AS server_id,\r\n      application AS application,\r\n      &{date_format(@create_time)} AS date_time,\r\n      counter,\r\n      VALUE\r\n    FROM\r\n      wareahouse_open_falcon_src\r\n    WHERE\r\n      ●_CREATE_TIME_● = (\r\n        SELECT\r\n          max(●_CREATE_TIME_●)\r\n        FROM\r\n          wareahouse_open_falcon_src\r\n        WHERE\r\n          counter = \'Select_range\'\r\n      )\r\n    AND counter = \'Select_range\'\r\n  ) table1\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'Com_insert\'\r\n    )\r\n  AND counter = \'Com_insert\'\r\n) table2 ON table2.server_id = table1.server_id\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'Com_update\'\r\n    )\r\n  AND counter =  \'Com_update\'\r\n) table3 ON table2.server_id = table3.server_id\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'Com_delete\'\r\n    )\r\n  AND counter = \'Com_delete\'\r\n) table4 ON table4.server_id = table3.server_id\r\nAND table1.application = table2.application\r\nAND table2.application = table3.application\r\nAND table3.application = table4.application\r\nAND table2.date_time = table1.date_time \r\nAND table2.date_time = table3.date_time \r\nAND table3.date_time = table4.date_time ', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_throughput_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('608', '1', '1', NULL, 'Mysql监控-性能信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	table1.server_id AS service_id,\r\n	table1.date_time AS date_time,\r\n	table1.application AS application,\r\n	ROUND ( table1.VALUE, 2 ) AS select_join_range,\r\n	ROUND ( table2.VALUE, 2 ) AS select_all_count \r\nFROM\r\n	(\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter =  \'Select_range\' ) \r\n		AND counter =  \'Select_range\' \r\n	) table1\r\n	JOIN (\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter =  \'Com_select\'  ) \r\n		AND counter = \'Com_select\'\r\n	) table2 ON table2.server_id = table1.server_id \r\n	AND table1.application = table2.application \r\n	AND table2.date_time = table1.date_time', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_property_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('609', '1', '1', NULL, 'Mysql监控-连接情况', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n  table1.server_id AS service_id,\r\n  table1.date_time AS date_time,\r\n table1.application AS application,\r\n	ROUND ( table1.VALUE, 2 ) AS db_joint_count,\r\n	ROUND ( table2.VALUE, 2 ) AS db_max_joint_count\r\nFROM\r\n  (\r\n    SELECT\r\n      endpoint AS server_id,\r\n      application AS application,\r\n      &{date_format(@create_time)} AS date_time,\r\n      counter,\r\n      VALUE\r\n    FROM\r\n      wareahouse_open_falcon_src\r\n    WHERE\r\n      ●_CREATE_TIME_● = (\r\n        SELECT\r\n          max(●_CREATE_TIME_●)\r\n        FROM\r\n          wareahouse_open_falcon_src\r\n        WHERE\r\n          counter = \'max_connections\'\r\n      )\r\n    AND counter = \'max_connections\'\r\n  ) table1\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'Max_used_connections\'\r\n    )\r\n  AND counter = \'Max_used_connections\'\r\n) table2 ON table2.server_id = table1.server_id\r\nAND table1.application = table2.application\r\nAND table2.date_time = table1.date_time ', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_joint_condition', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('610', '1', '1', NULL, 'Mysql监控-字节信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n  table1.server_id AS service_id,\r\n  table1.date_time AS date_time,\r\n table1.application AS application,\r\n ROUND ( table1.VALUE, 2 ) AS receive_byte_count,\r\n ROUND ( table2.VALUE, 2 ) AS send_byte_count\r\nFROM\r\n  (\r\n    SELECT\r\n      endpoint AS server_id,\r\n      application AS application,\r\n      &{date_format(@create_time)} AS date_time,\r\n      counter,\r\n      VALUE\r\n    FROM\r\n      wareahouse_open_falcon_src\r\n    WHERE\r\n      ●_CREATE_TIME_● = (\r\n        SELECT\r\n          max(●_CREATE_TIME_●)\r\n        FROM\r\n          wareahouse_open_falcon_src\r\n        WHERE\r\n          counter = \'Bytes_received\'\r\n      )\r\n    AND counter = \'Bytes_received\'\r\n  ) table1\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'Bytes_sent\'\r\n    )\r\n  AND counter = \'Bytes_sent\'\r\n) table2 ON table2.server_id = table1.server_id\r\nAND table1.application = table2.application\r\nAND table2.date_time = table1.date_time ', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_mysql_byte_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('611', '1', '1', NULL, 'Redis内存碎片情况', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	table1.server_id AS service_id,\r\n	table1.date_time AS date_time,\r\n	table1.application AS application,\r\n	ROUND ( table1.VALUE, 2 ) AS physics_all_storage,\r\n	ROUND ( table2.VALUE, 2 ) AS distributor_all_storage \r\nFROM\r\n	(\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter =  \'redis.used_memory\' ) \r\n		AND counter =  \'redis.used_memory\' \r\n	) table1\r\n	JOIN (\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter =  \'redis.used_memory_rss\' ) \r\n		AND counter =  \'redis.used_memory_rss\' \r\n	) table2 ON table2.server_id = table1.server_id \r\n	AND table1.application = table2.application \r\n	AND table2.date_time = table1.date_time', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_redis_storage_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('612', '1', '1', NULL, 'Redis监控-状态监控', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	table1.server_id AS service_id,\r\n	table1.date_time AS date_time,\r\n	table1.application AS application,\r\n	ROUND ( table1.VALUE, 2 ) AS server_joint_client_count,\r\n	ROUND ( table2.VALUE, 2 ) AS server_execute_sum,\r\nCASE\r\n		\r\n		WHEN table3.VALUE > 0 THEN\r\n		\'正常\' \r\n		WHEN table3.VALUE <= 0 THEN\r\n		\'不正常\' \r\n	END AS state,\r\n	table4.VALUE  AS joint_client_count \r\nFROM\r\n	(\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter =  \'redis.used_memory\' ) \r\n		AND counter =  \'redis.used_memory\'\r\n	) table1\r\n	JOIN (\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'redis.total_commands_processed\' ) \r\n		AND counter =  \'redis.total_commands_processed\'\r\n	) table2 ON table2.server_id = table1.server_id\r\n	JOIN (\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter =  \'redis.blocked_clients\' ) \r\n		AND counter = \'redis.blocked_clients\'\r\n	) table3 ON table2.server_id = table3.server_id\r\n	JOIN (\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter = \'redis.connected_clients\' ) \r\n		AND counter =  \'redis.connected_clients\'\r\n	) table4 ON table4.server_id = table3.server_id \r\n	AND table1.application = table2.application \r\n	AND table2.application = table3.application \r\n	AND table3.application = table4.application \r\n	AND table2.date_time = table1.date_time \r\n	AND table2.date_time = table3.date_time \r\n	AND table3.date_time = table4.date_time', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_redis_state_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('613', '1', '1', NULL, 'Redis监控-内存碎片信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	table1.server_id AS service_id,\r\n	table1.date_time AS date_time,\r\n	table1.application AS application,\r\n	ROUND ( table1.VALUE, 2 ) AS mem_fragmentation \r\nFROM\r\n	(\r\n	SELECT\r\n		endpoint AS server_id,\r\n		application AS application,\r\n		&{date_format(@create_time)} AS date_time,\r\n		counter,\r\n		VALUE \r\n	FROM\r\n		wareahouse_open_falcon_src \r\n	WHERE\r\n		●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM wareahouse_open_falcon_src WHERE counter =  \'redis.mem_fragmentation_ratio\' ) \r\n	AND counter = \'redis.mem_fragmentation_ratio\' \r\n	) table1', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_redis_mem_fragmentation', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('614', '1', '1', NULL, 'Redis监控-key信息', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n  table1.server_id AS service_id,\r\n  table1.date_time AS date_time,\r\n table1.application AS application,\r\n &{double_format(@table1.VALUE)}   AS redis_keyspace_hits,\r\n &{double_format(@table2.VALUE)}  AS redis_total_commands_processed\r\nFROM\r\n  (\r\n    SELECT\r\n      endpoint AS server_id,\r\n      application AS application,\r\n      &{date_format(@create_time)} AS date_time,\r\n      counter,\r\n      VALUE\r\n    FROM\r\n      wareahouse_open_falcon_src\r\n    WHERE\r\n      ●_CREATE_TIME_● = (\r\n        SELECT\r\n          max(●_CREATE_TIME_●)\r\n        FROM\r\n          wareahouse_open_falcon_src\r\n        WHERE\r\n          counter = \'redis.keyspace_hits\'\r\n      )\r\n    AND counter = \'redis.keyspace_hits\'\r\n  ) table1\r\nJOIN (\r\n  SELECT\r\n    endpoint AS server_id,\r\n    application AS application,\r\n    &{date_format(@create_time)} AS date_time,\r\n    counter,\r\n    VALUE\r\n  FROM\r\n    wareahouse_open_falcon_src\r\n  WHERE\r\n    ●_CREATE_TIME_● = (\r\n      SELECT\r\n        max(●_CREATE_TIME_●)\r\n      FROM\r\n        wareahouse_open_falcon_src\r\n      WHERE\r\n        counter = \'redis.keyspace_misses\'\r\n    )\r\n  AND counter = \'redis.keyspace_misses\'\r\n) table2 ON table2.server_id = table1.server_id\r\nAND table1.application = table2.application\r\nAND table2.date_time = table1.date_time ', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'service_redis_key_info', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('999', '1', '1', NULL, '抖音每天数据fake数据', '0 0 10 * * ? ', 'SELECT\n	date_time,\n	apeople_count - bpeople_count AS people_count,\n	avideo_count - bvideo_count AS video_count \nFROM\n	( SELECT people_count apeople_count, video_count avideo_count, date_time FROM douyin_original_statistics_copy ORDER BY date_time DESC LIMIT 1 ) as  t1\n	JOIN ( SELECT people_count bpeople_count, video_count bvideo_count, date_time AS date_tie FROM douyin_original_statistics_copy ORDER BY date_time DESC LIMIT 1 ) as t2 on 1=1', '抖音每天数据fake数据 每天10点执行', '4', '', '0', '', NULL, 'douyin_original_statistics', NULL, '1', '1', '1', '1', '2020-01-10 13:30:00', '2020-01-10 13:30:00', '', '', b'00', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1003', '1', '1', NULL, '职工观影放映场次及观影人数', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	temp1.detail_start_time as date,\r\n	user_id as pople_numbers,\r\n	schedule_id as showings_sum\r\nFROM\r\n	(\r\n		SELECT\r\n			&{date_format_date(@detail_start_time)} AS detail_start_time,\r\n			count(DISTINCT user_id) AS user_id\r\n		FROM\r\n			t_order\r\n		WHERE\r\n			is_delete = 2\r\n		GROUP BY\r\n			&{date_format_date(@detail_start_time)}\r\n	) temp1\r\nJOIN (\r\n	SELECT\r\n		&{date_format_date(@detail_start_time)} AS detail_start_time,\r\n		count(DISTINCT schedule_id) AS schedule_id\r\n	FROM\r\n		t_order\r\n	WHERE\r\n		is_delete = 2\r\n	GROUP BY\r\n		&{date_format_date(@detail_start_time)}\r\n) tmp2 ON temp1.detail_start_time = tmp2.detail_start_time \r\norder by temp1.detail_start_time desc  limit 15', '职工观影放映场次及观影人数 , 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'online_movie_showing_sum_pople_sum', NULL, '1', '1', '3', '1', '2020-01-10 13:30:00', '2020-01-10 13:30:00', '', '', b'00', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1302', '1', '1', NULL, '摩拜单车骑行区域占比', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'select area, count(1) as rate FROM (\r\nSELECT\r\n	t_district.name AS area\r\nFROM\r\n	mobike_order\r\nJOIN t_district ON start_position LIKE CONCAT(\'%\', t_district.name, \'%\')\r\n)tmp_table group by  area', '摩拜单车骑行区域占比， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_mobike_area_rate', NULL, '1', '1', '3', '1', '2020-01-10 10:22:33', '2020-01-10 10:22:33', '', '', b'00', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1304', '1', '1', NULL, '摩拜单车实时订单', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	&{date_format_date_time(@end_time)} AS order_time,\r\n	nick_name AS USER,\r\n	\'完成一笔订单\' AS state\r\nFROM\r\n	mobike_order\r\nWHERE\r\n	start_position LIKE \'%四川省成都市%\'\r\nAND end_time IS NOT NULL\r\nORDER BY\r\n	end_time DESC\r\nLIMIT 20', '摩拜单车实时订单， 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_mobike_real_time_order', NULL, '1', '1', '3', '1', '2020-01-10 10:27:00', '2020-01-10 10:27:00', '', '', b'00', '36', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1305', '1', '1', NULL, '机票订单目的地', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n ●ArriveCityName● AS city,\r\n count( 1 ) AS count \r\nFROM\r\n airticket_bookingrequestflight \r\nGROUP BY\r\n ●ArriveCityName● \r\nORDER BY\r\n count DESC \r\n LIMIT 10\r\n ', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_ticket_purpose_city', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1306', '1', '1', NULL, '职工商旅实时订单', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', '	SELECT\r\n &{date_format_date_time(@●CreateTime●)}  AS order_time,\r\n CONCAT(●ArriveCityName●,\'———>\',●DepartCityName●) as order_detail,\r\n \'完成一笔订单\' as state\r\nFROM\r\n airticket_bookingrequestflight\r\n JOIN airticket_ticketingorderstatus ON ●TicketingOrderId● = ●BookingRequestId● \r\nWHERE\r\n ●OrderStatus● = \'1\' \r\nORDER BY\r\n ●CreateTime● DESC \r\n LIMIT 30', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_trade_real_time_order', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1307', '1', '1', NULL, '职工打车距离分布', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	distance,\r\n	sum(person_count) AS person_count\r\nFROM\r\n	(\r\n		SELECT\r\n			CASE distance\r\n		WHEN 0 THEN\r\n			\'0-5km\'\r\n		WHEN 1 THEN\r\n			\'5-10km\'\r\n		WHEN 2 THEN\r\n			\'10-15km\'\r\n		WHEN 3 THEN\r\n			\'15-20km\'\r\n		ELSE\r\n			\'20km以上\'\r\n		END AS distance,\r\n		person_count\r\n	FROM\r\n		(\r\n			SELECT\r\n				distance AS distance,\r\n				count(1) AS person_count\r\n			FROM\r\n				(\r\n					SELECT\r\n						&{special_case_number(@distance)} AS distance\r\n					FROM\r\n						(\r\n							SELECT\r\n								distance / 5000 AS distance\r\n							FROM\r\n								t_order_info\r\n							WHERE\r\n								distance IS NOT NULL\r\n						) tmp\r\n				) out_tmp\r\n			GROUP BY\r\n				distance\r\n			ORDER BY\r\n				distance\r\n		) tab\r\n	) t\r\nGROUP BY\r\n	distance', '职工打车距离分布每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_car_distance', NULL, '1', '1', '3', '1', '2020-01-10 10:48:51', '2020-01-10 10:48:51', '', '', b'00', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1309', '1', '1', NULL, '职工打车实时订单', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	&{date_format_date_time(@●createTime●)} as order_time,\r\n	●userAccount● as user,\r\n	●statusName●  as state\r\nFROM\r\n	t_order_info\r\nORDER BY\r\n	●createTime● DESC\r\nLIMIT 30', '职工打车实时订单, 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_car_real_time_order', NULL, '1', '1', '3', '1', '2020-01-10 10:51:32', '2020-01-10 10:51:32', '', '', b'00', '36', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1311', '1', '1', NULL, '职工观影实时订单', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	&{date_format_date_time(@buy_time)} AS order_time,\r\n	show_name AS movie_name,\r\n	cinema_name AS cinema_name, \'完成一笔订单\' as state\r\nFROM\r\n	t_order\r\nWHERE\r\n	is_delete = 2\r\nORDER BY\r\n	buy_time DESC\r\nLIMIT 30', '职工观影实时订单 , 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_movie_real_time_order', NULL, '1', '1', '3', '1', '2020-01-10 13:33:17', '2020-01-10 13:33:17', '', '', b'00', '36', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1312', '1', '1', NULL, '职工订餐时间占比分布', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'select \'早餐\'as time,  count(1) rate from (\r\nSELECT\r\n	&{date_format(@●orderTime●)} AS orderTime\r\nFROM\r\n	t_order_meal\r\nWHERE\r\n	(\r\n		●orderStatusName● = \'完成订单\'\r\n		OR ●orderStatusName● = \'确认送达\'\r\n	)\r\nAND \'06:00\' < &{date_format(@●orderTime●)}\r\nAND &{date_format(@●orderTime●)} < \'11:00\') t1\r\nUNION\r\nselect \'午餐\' as time,  count(1) rate from (\r\nSELECT\r\n	&{date_format(@●orderTime●)} AS orderTime\r\nFROM\r\n	t_order_meal\r\nWHERE\r\n	(\r\n		●orderStatusName● = \'完成订单\'\r\n		OR ●orderStatusName● = \'确认送达\'\r\n	)\r\nAND \'11:00\' <= &{date_format(@●orderTime●)}\r\nAND &{date_format(@●orderTime●)} < \'12:00\')t2\r\nUNION\r\nselect \'下午茶\'as time,  count(1) rate from (\r\nSELECT\r\n	&{date_format(@●orderTime●)} AS orderTime\r\nFROM\r\n	t_order_meal\r\nWHERE\r\n	(\r\n		●orderStatusName● = \'完成订单\'\r\n		OR ●orderStatusName● = \'确认送达\'\r\n	)\r\nAND \'13:00\' <= &{date_format(@●orderTime●)}\r\nAND &{date_format(@●orderTime●)} < \'17:00\') tt\r\nUNION\r\nselect \'晚餐\'as time,  count(1) rate from (\r\nSELECT\r\n	&{date_format(@●orderTime●)} AS orderTime\r\nFROM\r\n	t_order_meal\r\nWHERE\r\n	(\r\n		●orderStatusName● = \'完成订单\'\r\n		OR ●orderStatusName● = \'确认送达\'\r\n	)\r\nAND \'17:00\' <= &{date_format(@●orderTime●)}\r\nAND &{date_format(@●orderTime●)} < \'22:00\') tmpp\r\nUNION\r\nselect \'夜宵\'as time,  count(1) rate from (\r\nSELECT\r\n	&{date_format(@●orderTime●)} AS orderTime\r\nFROM\r\n	t_order_meal\r\nWHERE\r\n	(\r\n		●orderStatusName● = \'完成订单\'\r\n		OR ●orderStatusName● = \'确认送达\'\r\n	)\r\nAND ((\'22:00\' <= &{date_format(@●orderTime●)}\r\nAND &{date_format(@●orderTime●)} < \'24:00\' ) or (\'00:00\' <= &{date_format(@●orderTime●)}\r\nAND &{date_format(@●orderTime●)} < \'06:00\' ))\r\n)tmp', '职工订餐时间占比分布 , 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_meal_time', NULL, '1', '1', '3', '1', '2020-01-10 15:34:52', '2020-01-10 15:34:52', '', '', b'00', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1315', '1', '1', NULL, '职工订餐实时订单', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT &{date_format_date_time(@●orderTime●)} AS order_time,\r\n●merchantName● AS merchant_name,\r\n\'完成一笔订单\' AS state \r\nFROM\r\n	t_order_meal \r\nORDER BY\r\n	●orderTime● DESC \r\n	LIMIT 30', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_meal_real_time_order', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1317', '1', '1', NULL, '福利数据', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	count as welfare_sum,\r\n	value as welfare_pay_balance\r\nFROM\r\n	t_demo_data\r\nWHERE\r\n	name_id = \'city_welfare_data\' and  ●_CREATE_TIME_● = (select MAX(●_CREATE_TIME_●) from t_demo_data WHERE name_id = \'city_welfare_data\' )', '福利数据,, 每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_welfare_data', NULL, '1', '1', '3', '1', '2020-01-11 20:01:50', '2020-01-11 20:01:52', '', '', b'00', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1318', '1', '1', NULL, '线下商户', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	latitude,\r\n	NAME,\r\n	picture,\r\n	longitude \r\nFROM\r\n	city_offline_merchant \r\nWHERE\r\n	●_CREATE_TIME_● = ( SELECT max( ●_CREATE_TIME_● ) FROM city_offline_merchant )', '每1.6执行', '4', '', '0', '', NULL, 'city_offline_merchant', NULL, '1', '1', '3', '1', '2020-01-11 22:18:12', '2020-01-11 22:18:09', '', '', b'01', '36', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1322', '1', '1', NULL, '线上线下实时订单', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'SELECT\r\n	&{date_format_date_time(@order_time)} as order_time,\r\n	merchant_name,\r\n	\'完成一笔订单\' AS state\r\nFROM\r\n	(\r\n		(\r\n			SELECT\r\n				pay_finish_time AS order_time,\r\n				SUBJECT AS merchant_name\r\n			FROM\r\n				pay_orders\r\n			WHERE\r\n				pay_finish_time IS NOT NULL\r\n			ORDER BY\r\n				pay_finish_time DESC\r\n			LIMIT 50\r\n		)\r\n		UNION\r\n			(\r\n				SELECT\r\n					create_time AS order_time,\r\n					store_name AS merchant_name\r\n				FROM\r\n					pay_cashier_orders\r\n				ORDER BY\r\n					create_time DESC\r\n				LIMIT 50\r\n			)\r\n		UNION\r\n			(\r\n				SELECT\r\n					create_time AS order_time,\r\n					\'红旗超市\' AS merchant_name\r\n				FROM\r\n					pay_wallet_unionpay_transaction_log\r\n				WHERE\r\n					mer_name LIKE \'%红旗%\'\r\n				ORDER BY\r\n					create_time DESC\r\n				LIMIT 50\r\n			)\r\n		UNION\r\n			(\r\n				SELECT\r\n					create_time AS order_time,\r\n					CASE pay_src\r\n				WHEN 11 THEN\r\n					\'富宏贩卖机\'\r\n				WHEN 12 THEN\r\n					\'聚蓉惠自动贩卖机\'\r\n				WHEN 21 THEN\r\n					\'华润贩卖机\'\r\n				ELSE\r\n					\'富宏贩卖机\'\r\n				END AS merchant_name\r\n				FROM\r\n					orders_money_pay_request\r\n				WHERE\r\n					●dataStatus● = 0\r\n				AND pay_state = 1\r\n				AND pay_src IN (11, 12, 21)\r\n				ORDER BY\r\n					create_time DESC\r\n				LIMIT 50\r\n			)\r\n	) tmp4\r\nORDER BY\r\n	order_time DESC', '每分钟 1 ， 6 开始执行', '4', '', '0', '', NULL, 'city_offline_onunderline_real_time_order', NULL, '1', '1', '3', '1', '2020-01-09 17:45:38', '2020-01-09 17:45:38', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1325', '1', '1', NULL, '服务器监控', '0 1,6,11,16,21,26,31,36,41,46,51,56 * * * ? ', 'select java_apply,redis_apply,mysql_apply,notice_count, java_apply+redis_apply+mysql_apply+notice_count as message_count from (\r\nSELECT (SELECT count(distinct application) from wareahouse_open_falcon_src where counter=\'thread.active.count\') as java_apply,\r\n(SELECT count(distinct application) from wareahouse_open_falcon_src where counter=\'redis.blocked_clients\'   )  as redis_apply,\r\n(SELECT count(distinct application) from wareahouse_open_falcon_src where counter=\'Select_range\' )          as mysql_apply,\r\n(SELECT count(distinct endpoint) from wareahouse_open_falcon_src where counter=\'cpu.user\'       )          as notice_count \r\n) tmp', '服务器监控， 每1.6执行', '4', '', '0', '', NULL, 'service_server_monitor_two', NULL, '1', '1', '3', '1', '2020-01-11 22:18:12', '2020-01-11 22:18:09', '', '', b'01', '24', '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1601', '1', '1', NULL, '平台数据', '0 0/10 * * * ? ', 'select day_person_app,day_video_app,day_person_trill,day_video_trill,accumulative_person_trill,accumulative_video_app,accumulative_person_trill,accumulative_video_trill,accumulative_person_app,\r\n(select sum(prize) from (\r\nSELECT  &{case_number(@●prizeName●)} as prize FROM lottery_win_prize ORDER BY ●createTime● \r\n)t )grant_sum,\r\naccumulative_person_trill + \r\naccumulative_person_app as accumulative_reference_person,\r\naccumulative_video_trill +\r\naccumulative_video_app as accumulative_reference_video,\r\nday_person_trill +\r\nday_person_app as day_reference_person,\r\nday_video_trill + \r\nday_video_app as day_reference_video\r\n from \r\n(\r\nselect  \r\n(SELECT COUNT(DISTINCT app_user_id) from  video_playback_info WHERE &{date_format_date(@create_time)} = &{date_format_date(NOW())} and app_user_id is not null) + (\r\nSELECT COUNT( 1 ) from  video_like_info WHERE &{date_format_date(@create_time)} = &{date_format_date(NOW())} and app_user_id is not null\r\n) as day_person_app,\r\n(SELECT COUNT(1) from  video_playback_info WHERE &{date_format_date(@create_time)} = &{date_format_date(NOW())} ) as day_video_app,\r\n(select people_count from douyin_original_statistics WHERE &{date_format_date(@date_time)} = &{date_format_date(NOW())} )as day_person_trill  ,\r\n(select video_count from douyin_original_statistics WHERE &{date_format_date(@date_time)} = &{date_format_date(NOW())} ) as day_video_trill,\r\n\r\n(SELECT COUNT(DISTINCT app_user_id) from  video_playback_info WHERE   app_user_id is not null) + + (\r\nSELECT COUNT( 1 ) from  video_like_info where  app_user_id is not null\r\n) as accumulative_person_app,\r\n(SELECT COUNT(1) from  video_playback_info)  as accumulative_video_app,\r\n(select sum(people_count) from douyin_original_statistics) as accumulative_person_trill,\r\n(select sum(video_count) from douyin_original_statistics)  as accumulative_video_trill\r\n)tmp\r\n', '每1、6开始执行，平台数据', '4', '', '', '', NULL, 'new_year_terrace_data', NULL, '0', '1', '3', '0', '2020-01-30 01:53:13', '2020-01-30 01:53:15', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1602', '1', '1', NULL, '区县参与人数分布', '0 0/10 * * * ? ', 'select * from (\r\nSELECT area, SUM(count) as count from (\r\nSELECT\r\n  t_district.name as area,cnt as count\r\nFROM\r\n (\r\n  SELECT\r\n    &{case_number(@create_id)} as  create_id,\r\n    count(1) AS cnt\r\n  FROM\r\n    video_playback_info\r\n  WHERE\r\n    create_id IS NOT NULL\r\n  GROUP BY\r\n    create_id\r\n) tmp   \r\nJOIN customer_info on customer_info.id=tmp.create_id\r\nJOIN admin_organization ON admin_organization.id = customer_info.labor_union_id\r\nJOIN t_district on admin_organization.name LIKE CONCAT(\'%\', t_district.name, \'%\')\r\nwhere t_district.name != \'成都市\'\r\n)tmp  GROUP BY area\r\n)tmp_table  ORDER BY count DESC', '每1、6开始执行，区县参与人数分布', '4', '', '', '', NULL, 'new_year_county_person_distribute', NULL, '0', '1', '3', '0', '2020-01-30 00:47:16', '2020-01-30 00:47:18', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1603', '1', '1', NULL, '平台最受欢迎家庭秀视频', '0 0/10 * * * ? ', 'SELECT\n	1 AS ranking,\n	upload_address AS path \nFROM\n	(\n	SELECT\n		video_id,\n		sum \n	FROM\n		(\n		SELECT\n			video_id,\n			views,\n			count,\n			views + count AS sum \n		FROM\n			video_playback_info\n			JOIN ( SELECT video_id, count( 1 ) count FROM video_like_info GROUP BY video_id ) t ON t.video_id = video_playback_info.id \n		) tt \n	ORDER BY\n		sum DESC \n	) ttt\n	JOIN video_playback_info ON video_id = video_playback_info.id \nWHERE\n	upload_address  NOt IN ( SELECT path FROM lottery_invalid_video_path ) \nORDER BY\n	sum DESC \n	LIMIT 10', '每1、6开始执行，生产 平台最受欢迎家庭秀视频 数据', '4', '', '', '', NULL, 'new_year_welcome_video', NULL, '0', '1', '3', '0', '2020-01-29 21:53:28', '2020-01-29 21:53:30', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1604', '1', '1', NULL, '平台视频播放量-点赞量排名TOP10', '0 0/10 * * * ? ', 'select  \'\' as ranking, video_name, views as play_count ,count as praise_count   from (\r\nselect \'\' as ranking, video_name, views , count ,views+ count as  sum from video_playback_info join \r\n(select video_id , count(1) count  from  video_like_info  GROUP BY video_id) t\r\non t.video_id = video_playback_info.id\r\n)tt order by sum desc limit 10\r\n', '每1、6开始执行，平台视频播放量-点赞量排名TOP10', '4', '', '', '', NULL, 'new_year_video_top10', NULL, '0', '1', '3', '0', '2020-01-30 00:15:16', '2020-01-30 00:15:18', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1605', '1', '1', NULL, '平台审核数据', '0 0/10 * * * ? ', 'select \r\n(select count(1) from video_playback_info where exa_type = 4 and is_remove = 1) as yes_audit,\r\n(select count(1) from video_playback_info where exa_type = 3 ) as pass_video,\r\n(select count(1) from video_playback_info where exa_type = 2  ) as no_audit', '每1、6开始执行，生产 平台审核数据', '4', '', '', '', NULL, 'new_year_terrace_audit_data', NULL, '0', '1', '3', '0', '2020-01-29 21:59:05', '2020-01-29 21:59:07', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1606', '1', '1', NULL, '平台中奖人数分布', '0 0/10 * * * ? ', 'select create_time as date, first_prize,second_prize,third_prize, views as upload ,count as lottery_person  from (\r\nselect create_time, sum(views) as views , sum(count) as count from (\r\nSELECT\r\n	&{date_format_month(@create_time)}  as create_time ,video_playback_info.views as views,count as count\r\nFROM\r\n	video_playback_info\r\nJOIN (select video_id , count(1) count from video_like_info GROUP BY video_id) tmp ON tmp.video_id = video_playback_info.id\r\nWHERE\r\n	video_playback_info.is_remove = 1\r\nAND video_playback_info.exa_type = 4\r\n)out_table GROUP BY create_time\r\n\r\n)tmp join (SELECT\r\n		lottery_video_prize_list_statistics.date_time as date_time,\r\n		table1.a as first_prize,\r\n		table2.b as second_prize,\r\n		table3.c as third_prize\r\n	FROM\r\n		lottery_video_prize_list_statistics\r\n		JOIN ( SELECT date_time, count( prize_class ) as a FROM lottery_video_prize_list_statistics WHERE prize_class = \'一等奖\' GROUP  BY date_time) table1 ON lottery_video_prize_list_statistics.date_time = table1.date_time\r\n		JOIN ( SELECT date_time, count( prize_class ) as b FROM lottery_video_prize_list_statistics WHERE prize_class = \'二等奖\' GROUP  BY date_time) table2 ON lottery_video_prize_list_statistics.date_time = table2.date_time\r\n		JOIN ( SELECT date_time, count( prize_class ) as c FROM lottery_video_prize_list_statistics WHERE prize_class = \'三等奖\' GROUP  BY date_time) table3 ON table1.date_time = table3.date_time\r\n	) tab on &{date_format_month(@tab.date_time)}   = tmp.create_time ORDER BY create_time asc', '每1、6开始执行，平台中奖人数分布', '4', '', '', '', NULL, 'new_year_terrace_award_distribute', NULL, '0', '1', '3', '0', '2020-01-30 13:33:05', '2020-01-30 13:33:08', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1607', '1', '1', NULL, '平台C端活跃用户', '0 0/10 * * * ? ', 'select CONCAT(first_name,\'*\',end_name ) as user_name,count from (\r\n SELECT\r\n	substring(user_name FROM 1 FOR 1) AS first_name,\r\n	RIGHT(user_name ,1 ) AS end_name,count\r\n from (\r\n\r\nSELECT\r\n	real_name as user_name, LENGTH(real_name) origin_length,LENGTH(real_name) / 3 - 1 AS send_use_name_length, tmp.count as count\r\nFROM\r\n	customer\r\nJOIN (\r\n	select * from (\r\n SELECT\r\n		upload_phone,\r\n		count(1) AS count\r\n	FROM\r\n		video_playback_info\r\n	WHERE\r\n		upload_phone IS NOT NULL\r\n	GROUP BY\r\n		upload_phone\r\n) t order by count desc limit 10\r\n) tmp ON tmp.upload_phone = customer.mobile order BY count asc \r\n)tmp1\r\n)tmp2', '每1、6开始执行，平台C端活跃用户', '4', '', '', '', NULL, 'new_year_terrace_active_user', NULL, '0', '1', '3', '0', '2020-01-30 00:01:09', '2020-01-30 00:01:12', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1701', '1', '1', NULL, '平台数据', '0 0/10 * * * ? ', 'select day_person_app,day_video_app,day_person_trill,day_video_trill,accumulative_person_trill,accumulative_video_app,accumulative_person_trill,accumulative_video_trill,accumulative_person_app,\r\n(select sum(prize) from (\r\nSELECT  &{case_number(@●prizeName●)} as prize FROM lottery_win_prize ORDER BY ●createTime● \r\n)t )grant_sum,\r\naccumulative_person_trill + \r\naccumulative_person_app as accumulative_reference_person,\r\naccumulative_video_trill +\r\naccumulative_video_app as accumulative_reference_video,\r\nday_person_trill +\r\nday_person_app as day_reference_person,\r\nday_video_trill + \r\nday_video_app as day_reference_video\r\n from \r\n(\r\nselect \r\n(SELECT COUNT(DISTINCT app_user_id) from  video_playback_info WHERE &{date_format_date(@create_time)} = &{date_format_date(NOW())} and app_user_id is not null) + (\r\nSELECT COUNT( 1 ) from  video_like_info WHERE &{date_format_date(@create_time)} = &{date_format_date(NOW())}     and app_user_id is not null\r\n) as day_person_app,\r\n(SELECT COUNT(1) from  video_playback_info WHERE &{date_format_date(@create_time)} = &{date_format_date(NOW())} ) as day_video_app,\r\n(select people_count from douyin_original_statistics WHERE &{date_format_date(@date_time)} = &{date_format_date(NOW())} ) as day_person_trill  ,\r\n(select video_count from douyin_original_statistics WHERE &{date_format_date(@date_time)} = &{date_format_date(NOW())}) as day_video_trill,\r\n\r\n(SELECT COUNT(DISTINCT app_user_id) from  video_playback_info WHERE   app_user_id is not null) + + (\r\nSELECT COUNT( 1 ) from  video_like_info where  app_user_id is not null\r\n) as accumulative_person_app,\r\n(SELECT COUNT(1) from  video_playback_info)  as accumulative_video_app,\r\n(select sum(people_count) from douyin_original_statistics) as accumulative_person_trill,\r\n(select sum(video_count) from douyin_original_statistics)  as accumulative_video_trill\r\n)tmp\r\n', '每1、6开始执行，平台数据', '4', '', '0', '', NULL, 'affect_moment_terrace_data', NULL, '1', '1', '3', '1', '2020-01-30 01:53:13', '2020-01-30 01:53:15', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1702', '1', '1', NULL, '区县参与人数分布', '0 0/10 * * * ? ', 'select * from (\r\nSELECT area, SUM(count) as count from (\r\nSELECT\r\n  t_district.name as area,cnt as count\r\nFROM\r\n (\r\n  SELECT\r\n    &{case_number(@create_id)} create_id,\r\n    count(1) AS cnt\r\n  FROM\r\n    video_playback_info\r\n  WHERE\r\n    create_id IS NOT NULL\r\n  GROUP BY\r\n    create_id\r\n) tmp   \r\nJOIN customer_info on customer_info.id=tmp.create_id\r\nJOIN admin_organization ON admin_organization.id = customer_info.labor_union_id\r\nJOIN t_district on admin_organization.name LIKE CONCAT(\'%\', t_district.name, \'%\')\r\nwhere t_district.name != \'成都市\'\r\n)tmp  GROUP BY area\r\n)tmp_table  ORDER BY count DESC', '每1、6开始执行，区县参与人数分布', '4', '', '0', '', NULL, 'affect_moment_county_person_distribute', NULL, '1', '1', '3', '1', '2020-01-30 00:47:16', '2020-01-30 00:47:18', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1703', '1', '1', NULL, '平台最受欢迎家庭秀视频', '0 0/10 * * * ? ', 'SELECT\r\n	1 AS ranking,\r\n	upload_address AS path \r\nFROM\r\n	(\r\n	SELECT\r\n		video_id,\r\n		sum \r\n	FROM\r\n		(\r\n		SELECT\r\n			video_id,\r\n			views,\r\n			count,\r\n			views + count AS sum \r\n		FROM\r\n			video_playback_info_\r\n			JOIN ( SELECT video_id, count( 1 ) count FROM video_like_info_ GROUP BY video_id ) t ON t.video_id = video_playback_info_.id \r\n		) tt \r\n	ORDER BY\r\n		sum DESC \r\n	) ttt\r\n	JOIN video_playback_info_ ON video_id = video_playback_info_.id \r\nWHERE\r\n	upload_address  NOt IN ( SELECT path FROM lottery_invalid_video_path ) \r\nORDER BY\r\n	sum DESC\r\n	LIMIT 10', '每1、6开始执行，生产 平台最受欢迎家庭秀视频 数据', '4', '', '0', '', NULL, 'affect_moment_welcome_video', NULL, '1', '1', '3', '1', '2020-01-29 21:53:28', '2020-01-29 21:53:30', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1704', '1', '1', NULL, '平台视频播放量-点赞量排名TOP10', '0 0/10 * * * ? ', 'select  \'\' as ranking, video_name, views as play_count ,count as praise_count   from (\r\nselect \'\' as ranking, video_name, views , count ,views+ count as  sum from video_playback_info_ join \r\n(select video_id , count(1) count  from  video_like_info_  GROUP BY video_id) t\r\non t.video_id = video_playback_info_.id\r\n)tt order by sum desc limit 10', '每1、6开始执行，平台视频播放量-点赞量排名TOP10', '4', '', '0', '', NULL, 'affect_moment_video_top10', NULL, '1', '1', '3', '1', '2020-01-30 00:15:16', '2020-01-30 00:15:18', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1705', '1', '1', NULL, '平台审核数据', '0 0/10 * * * ? ', 'select \r\n(select count(1) from video_playback_info_ where exa_type = 4 and is_remove = 1) as yes_audit,\r\n(select count(1) from video_playback_info_ where exa_type = 3 ) as pass_video,\r\n(select count(1) from video_playback_info_ where exa_type = 2  ) as no_audit', '每1、6开始执行，生产 平台审核数据', '4', '', '0', '', NULL, 'affect_moment_terrace_audit_data', NULL, '1', '1', '3', '1', '2020-01-29 21:59:05', '2020-01-29 21:59:07', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1706', '1', '1', NULL, '平台中奖人数分布', '0 0/10 * * * ? ', 'select create_time as date, first_prize,second_prize,third_prize, views as upload ,count as lottery_person  from (\r\nselect create_time, sum(views) as views , sum(count) as count from (\r\nSELECT\r\n	&{date_format_month(@create_time)}  as create_time ,video_playback_info_.views as views,count as count\r\nFROM\r\n	video_playback_info_\r\nJOIN (select video_id , count(1) count from video_like_info_ GROUP BY video_id) tmp ON tmp.video_id = video_playback_info_.id\r\nWHERE\r\n	video_playback_info_.is_remove = 1\r\nAND video_playback_info_.exa_type = 4\r\n)out_table GROUP BY create_time\r\n\r\n)tmp join (SELECT\r\n		lottery_video_prize_list_statistics.date_time as date_time,\r\n		table1.a as first_prize,\r\n		table2.b as second_prize,\r\n		table3.c as third_prize\r\n	FROM\r\n		lottery_video_prize_list_statistics\r\n		JOIN ( SELECT date_time, count( prize_class ) as a FROM lottery_video_prize_list_statistics WHERE prize_class = \'一等奖\' GROUP  BY date_time) table1 ON lottery_video_prize_list_statistics.date_time = table1.date_time\r\n		JOIN ( SELECT date_time, count( prize_class ) as b FROM lottery_video_prize_list_statistics WHERE prize_class = \'二等奖\' GROUP  BY date_time) table2 ON lottery_video_prize_list_statistics.date_time = table2.date_time\r\n		JOIN ( SELECT date_time, count( prize_class ) as c FROM lottery_video_prize_list_statistics WHERE prize_class = \'三等奖\' GROUP  BY date_time) table3 ON table1.date_time = table3.date_time\r\n	 ) tab on &{date_format_month(@tab.date_time)}    = tmp.create_time ORDER BY create_time Asc\r\n', '每1、6开始执行，平台中奖人数分布', '4', '', '0', '', NULL, 'affect_moment_terrace_award_distribute', NULL, '1', '1', '3', '1', '2020-01-30 13:33:05', '2020-01-30 13:33:08', '', '', b'01', NULL, '');
INSERT INTO `t_task_detail` (`id`, `subject_id`, `task_id`, `datasource_id`, `name`, `corn`, `exec_sql`, `content`, `task_type`, `schema_name`, `depend_task_id`, `source_table_name`, `source_source_id`, `target_table`, `target_source_id`, `cancel_exec`, `source_data_type`, `target_data_type`, `status`, `create_time`, `update_time`, `create_user`, `update_user`, `flag`, `hold_timeout`, `where_and`) VALUES ('1707', '1', '1', NULL, '平台C端活跃用户', '0 0/10 * * * ? ', 'select CONCAT(first_name,\'*\',end_name ) as user_name,count from (\r\n SELECT\r\n	substring(user_name FROM 1 FOR 1) AS first_name,\r\n	RIGHT(user_name ,1 ) AS end_name,count\r\n from (\r\n\r\nSELECT\r\n	real_name as user_name, LENGTH(real_name) origin_length,LENGTH(real_name) / 3 - 1 AS send_use_name_length, tmp.count as count\r\nFROM\r\n	customer\r\nJOIN (\r\n	select * from (\r\n SELECT\r\n		upload_phone,\r\n		count(1) AS count\r\n	FROM\r\n		video_playback_info\r\n	WHERE\r\n		upload_phone IS NOT NULL\r\n	GROUP BY\r\n		upload_phone\r\n) t order by count desc limit 10\r\n) tmp ON tmp.upload_phone = customer.mobile order BY count asc \r\n)tmp1\r\n)tmp2', '每1、6开始执行，平台C端活跃用户', '4', '', '0', '', NULL, 'affect_moment_terrace_active_user', NULL, '1', '1', '3', '1', '2020-01-30 00:01:09', '2020-01-30 00:01:12', '', '', b'01', NULL, '');
